import{t as H,a as R}from"../chunks/AuamoWko.js";import{i as G}from"../chunks/Bppcl8Q6.js";import{s as N,h as T,F as J,G as K,a as P,b as Q,m as E,I as Z,H as j,r as S,c as C,f as x,J as ee,d as V,e as Y,p as re,K as B,L as ae,M as ne,N as W,O as D,P as $,Q as te,R as se,S as oe,T as le,V as ie,w as fe,W as ce,X as ue,Y as ve,y as de,D as F,x as L,A as _e,Z as he,_ as pe,C as O,B as ge,z as me}from"../chunks/CRbPLMmM.js";import{e as we,s as be}from"../chunks/CNcxYGcq.js";import{i as ye}from"../chunks/DT-EGgzH.js";function Te(i,e){return e}function xe(i,e,a,u){for(var d=[],v=e.length,f=0;f<v;f++)oe(e[f].e,d,!0);var p=v>0&&d.length===0&&a!==null;if(p){var h=a.parentNode;le(h),h.append(a),u.clear(),w(i,e[0].prev,e[v-1].next)}ie(d,()=>{for(var t=0;t<v;t++){var r=e[t];p||(u.delete(r.k),w(i,r.prev,r.next)),fe(r.e,!p)}})}function Ee(i,e,a,u,d,v=null){var f=i,p={flags:e,items:new Map,first:null};{var h=i;f=T?N(J(h)):h.appendChild(K())}T&&P();var t=null,r=!1,c=Z(()=>{var n=a();return ae(n)?n:n==null?[]:B(n)});Q(()=>{var n=E(c),o=n.length;if(r&&o===0)return;r=o===0;let s=!1;if(T){var b=f.data===j;b!==(o===0)&&(f=S(),N(f),C(!1),s=!0)}if(T){for(var g=null,l,_=0;_<o;_++){if(x.nodeType===8&&x.data===ee){f=x,s=!0,C(!1);break}var A=n[_],y=u(A,_);l=X(x,p,g,null,A,y,_,d,e,a),p.items.set(y,l),g=l}o>0&&N(S())}T||Ae(n,p,f,d,e,u,a),v!==null&&(o===0?t?V(t):t=Y(()=>v(f)):t!==null&&re(t,()=>{t=null})),s&&C(!0),E(c)}),T&&(f=x)}function Ae(i,e,a,u,d,v,f){var p=i.length,h=e.items,t=e.first,r=t,c,n=null,o=[],s=[],b,g,l,_;for(_=0;_<p;_+=1){if(b=i[_],g=v(b,_),l=h.get(g),l===void 0){var A=r?r.e.nodes_start:a;n=X(A,e,n,n===null?e.first:n.next,b,g,_,u,d,f),h.set(g,n),o=[],s=[],r=n.next;continue}if(ke(l,b,_),l.e.f&D&&V(l.e),l!==r){if(c!==void 0&&c.has(l)){if(o.length<s.length){var y=s[0],m;n=y.prev;var M=o[0],k=o[o.length-1];for(m=0;m<o.length;m+=1)U(o[m],y,a);for(m=0;m<s.length;m+=1)c.delete(s[m]);w(e,M.prev,k.next),w(e,n,M),w(e,k,y),r=y,n=k,_-=1,o=[],s=[]}else c.delete(l),U(l,r,a),w(e,l.prev,l.next),w(e,l,n===null?e.first:n.next),w(e,n,l),n=l;continue}for(o=[],s=[];r!==null&&r.k!==g;)r.e.f&D||(c??(c=new Set)).add(r),s.push(r),r=r.next;if(r===null)continue;l=r}o.push(l),n=l,r=l.next}if(r!==null||c!==void 0){for(var I=c===void 0?[]:B(c);r!==null;)r.e.f&D||I.push(r),r=r.next;var q=I.length;if(q>0){var z=p===0?a:null;xe(e,I,z,h)}}$.first=e.first&&e.first.e,$.last=n&&n.e}function ke(i,e,a,u){se(i.v,e),i.i=a}function X(i,e,a,u,d,v,f,p,h,t){var r=(h&ce)!==0,c=(h&ue)===0,n=r?c?ne(d):W(d):d,o=h&te?W(f):f,s={i:o,v:n,k:v,a:null,e:null,prev:a,next:u};try{return s.e=Y(()=>p(i,n,o,t),T),s.e.prev=a&&a.e,s.e.next=u&&u.e,a===null?e.first=s:(a.next=s,a.e.next=s.e),u!==null&&(u.prev=s,u.e.prev=s.e),s}finally{}}function U(i,e,a){for(var u=i.next?i.next.e.nodes_start:a,d=e?e.e.nodes_start:a,v=i.e.nodes_start;v!==u;){var f=ve(v);d.before(v),v=f}}function w(i,e,a){e===null?i.first=a:(e.next=a,e.e.next=a&&a.e),a!==null&&(a.prev=e,a.e.prev=e&&e.e)}var Ie=H('<div class="message svelte-19b293w"> </div>'),Re=H('<div class="messages svelte-19b293w"></div> <button class="svelte-19b293w">Fetch Again</button>',1),Ne=H("<h1>WebTransport Client</h1> <!>",1);function We(i,e){de(e,!1);let a=pe([]);async function u(){try{console.log("Starting fetch to Axum...");const t=await fetch("/wtransport");if(!t.ok)throw new Error(`Response status: ${t.status}`);console.log("Received response:",t);const r=await t.json();console.log(r)}catch(t){console.error(t instanceof Error?t.message:"Unknown error occurred")}}async function d(){try{const t=new WebTransport("/wtransport");await t.ready,console.log("Connected to WebTransport server");const r=t.incomingUnidirectionalStreams,c=r.getReader();for(console.log(r),console.log(c);;){const{done:n,value:o}=await c.read();if(n)break;await v(o)}}catch(t){console.error("WebTransport connection error:",t)}}async function v(t){const r=t.getReader();for(;;){const{done:c,value:n}=await r.read();if(c)break;const o=new TextDecoder().decode(n),s=parseInt(o,10);isNaN(s)?console.warn("Failed to parse number:",o):(console.log("Number:",s),he(a,[...E(a),s]))}}d(),G();var f=Ne(),p=F(L(f),2);{var h=t=>{var r=Re(),c=L(r);Ee(c,5,()=>E(a),Te,(o,s,b,g)=>{var l=Ie(),_=ge(l,!0);O(l),me(()=>be(_,E(s))),R(o,l)}),O(c);var n=F(c,2);we("click",n,u),R(t,r)};ye(p,t=>{t(h,!1)})}R(i,f),_e()}export{We as component};
